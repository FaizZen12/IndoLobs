<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detail Produk Lobster - Lobster Marketplace</title>
    <link rel="stylesheet" href="style.css" />
    <style>
        body {
            background: #f5f7fa;
        }
        .product-detail-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        .product-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }
        .product-media {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 2px 12px rgba(38,122,74,0.09);
        }
        .product-img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 1rem;
        }
        .product-video {
            width: 100%;
            height: 300px;
            border-radius: 12px;
            background: #000;
        }
        .product-info {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 2px 12px rgba(38,122,74,0.09);
        }
        .product-title {
            color: #267a4a;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .product-price {
            font-size: 2.5rem;
            font-weight: bold;
            color: #f5b301;
            margin-bottom: 1rem;
        }
        .product-spec {
            list-style: none;
            padding: 0;
            margin-bottom: 2rem;
        }
        .product-spec li {
            padding: 0.8rem 0;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }
        .product-spec li:last-child {
            border-bottom: none;
        }
        .spec-label {
            font-weight: bold;
            color: #267a4a;
        }
        .spec-value {
            color: #1e3a3a;
        }
        .product-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        .product-cart-btn {
            background: #267a4a;
            color: #fff;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
            flex: 1;
        }
        .product-cart-btn:hover {
            background: #1e3a3a;
        }
        .wishlist-btn {
            background: #fff;
            color: #e74c3c;
            border: 2px solid #e74c3c;
            padding: 1rem;
            border-radius: 8px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .wishlist-btn:hover {
            background: #e74c3c;
            color: #fff;
        }
        .product-description {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(38,122,74,0.09);
        }
        .description-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #eee;
        }
        .tab-btn {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: bold;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        .tab-btn.active {
            color: #267a4a;
            border-bottom-color: #267a4a;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .product-reviews {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(38,122,74,0.09);
        }
        .review-item {
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .review-author {
            font-weight: bold;
            color: #267a4a;
        }
        .review-date {
            color: #666;
            font-size: 0.9rem;
        }
        .review-rating {
            color: #f5b301;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        .review-text {
            color: #1e3a3a;
            line-height: 1.5;
        }
        .shipping-info {
            background: #fff;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 12px rgba(38,122,74,0.09);
        }
        .shipping-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .shipping-item {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .shipping-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        .shipping-label {
            font-weight: bold;
            color: #267a4a;
            margin-bottom: 0.3rem;
        }
        .shipping-value {
            color: #666;
            font-size: 0.9rem;
        }
        @media (max-width: 768px) {
            .product-main {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            .product-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <nav class="main-navbar">
        <div class="nav-logo">ü¶û IndoLobs</div>
        <div class="nav-links">
            <a href="index.html">Beranda</a>
            <a href="marketplace.html">Marketplace</a>
            <a href="forum.html">Komunitas</a>
            <a href="news.html">Edukasi</a>
            <a href="dashboard.html">Dashboard</a>
        </div>
        <div class="nav-user" id="nav-user"></div>
    </nav>
    
    <main class="product-detail-container">
        <div class="product-main">
            <!-- Media Section -->
            <section class="product-media">
                <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80" alt="Lobster Air Tawar Super" class="product-img" />
                <video controls class="product-video">
                    <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
                    Video kondisi lobster tidak tersedia.
                </video>
            </section>
            
            <!-- Product Info Section -->
            <section class="product-info">
                <h1 class="product-title">Lobster Air Tawar Super</h1>
                <div class="product-rating">
                    <span>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                    <span>(4.8/5.0)</span>
                    <span>‚Ä¢ 127 ulasan</span>
                </div>
                <div class="product-price">Rp 650.000/kg</div>
                
                <ul class="product-spec">
                    <li>
                        <span class="spec-label">Jenis Lobster:</span>
                        <span class="spec-value">Air Tawar (Cherax quadricarinatus)</span>
                    </li>
                    <li>
                        <span class="spec-label">Ukuran:</span>
                        <span class="spec-value">15-20 cm</span>
                    </li>
                    <li>
                        <span class="spec-label">Berat:</span>
                        <span class="spec-value">300-500 gram per ekor</span>
                    </li>
                    <li>
                        <span class="spec-label">Umur:</span>
                        <span class="spec-value">8-10 bulan</span>
                    </li>
                    <li>
                        <span class="spec-label">Cara Budidaya:</span>
                        <span class="spec-value">Semi-intensif dengan pakan organik</span>
                    </li>
                    <li>
                        <span class="spec-label">Stok Tersedia:</span>
                        <span class="spec-value">25 kg (50 ekor)</span>
                    </li>
                    <li>
                        <span class="spec-label">Negara Tujuan Ekspor:</span>
                        <span class="spec-value">Singapore, Japan, USA, Australia</span>
                    </li>
                    <li>
                        <span class="spec-label">Estimasi Pengiriman:</span>
                        <span class="spec-value">2-3 hari domestik, 5-7 hari ekspor</span>
                    </li>
                </ul>
                
                <div class="product-actions">
                    <button id="add-to-cart" class="product-cart-btn" onclick="addToCart()">üõí Tambah ke Keranjang</button>
                    <button id="wishlistBtn" class="wishlist-btn" onclick="toggleWishlist()">‚ù§Ô∏è</button>
                </div>
            </section>
        </div>
        
        <!-- Product Description Tabs -->
        <section class="product-description">
            <div class="description-tabs">
                <button class="tab-btn active" onclick="showTab('description')">Deskripsi</button>
                <button class="tab-btn" onclick="showTab('specifications')">Spesifikasi</button>
                <button class="tab-btn" onclick="showTab('shipping')">Pengiriman</button>
            </div>
            
            <div id="description" class="tab-content active">
                <h3>Deskripsi Produk</h3>
                <p>Lobster Air Tawar Super adalah produk unggulan dari peternakan kami yang telah dibudidayakan dengan teknologi modern dan pakan berkualitas tinggi. Lobster ini memiliki daging yang tebal, rasa yang lezat, dan tekstur yang kenyal.</p>
                <p>Keunggulan produk:</p>
                <ul>
                    <li>‚úÖ Dibudidayakan dengan pakan organik premium</li>
                    <li>‚úÖ Bebas antibiotik dan bahan kimia berbahaya</li>
                    <li>‚úÖ Ukuran seragam dan berkualitas ekspor</li>
                    <li>‚úÖ Packing vacuum untuk menjaga kesegaran</li>
                    <li>‚úÖ Sertifikasi halal dan aman dikonsumsi</li>
                </ul>
            </div>
            
            <div id="specifications" class="tab-content">
                <h3>Spesifikasi Teknis</h3>
                <ul>
                    <li><strong>Nama Ilmiah:</strong> Cherax quadricarinatus</li>
                    <li><strong>Habitat:</strong> Air tawar dengan pH 6.5-8.0</li>
                    <li><strong>Suhu Optimal:</strong> 24-28¬∞C</li>
                    <li><strong>Kandungan Protein:</strong> 18-22%</li>
                    <li><strong>Kandungan Lemak:</strong> 1-3%</li>
                    <li><strong>Masa Panen:</strong> 8-10 bulan</li>
                    <li><strong>Survival Rate:</strong> 85-90%</li>
                </ul>
            </div>
            
            <div id="shipping" class="tab-content">
                <h3>Informasi Pengiriman</h3>
                <div class="shipping-grid">
                    <div class="shipping-item">
                        <div class="shipping-icon">üöö</div>
                        <div class="shipping-label">Domestik</div>
                        <div class="shipping-value">2-3 hari kerja</div>
                    </div>
                    <div class="shipping-item">
                        <div class="shipping-icon">‚úàÔ∏è</div>
                        <div class="shipping-label">Ekspor</div>
                        <div class="shipping-value">5-7 hari kerja</div>
                    </div>
                    <div class="shipping-item">
                        <div class="shipping-icon">üì¶</div>
                        <div class="shipping-label">Packing</div>
                        <div class="shipping-value">Vacuum + Es Kering</div>
                    </div>
                    <div class="shipping-item">
                        <div class="shipping-icon">üå°Ô∏è</div>
                        <div class="shipping-label">Suhu</div>
                        <div class="shipping-value">2-4¬∞C</div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Product Reviews -->
        <section class="product-reviews">
            <h2>‚≠ê Ulasan Produk</h2>
            <div class="review-item">
                <div class="review-header">
                    <div class="review-author">Budi Santoso</div>
                    <div class="review-date">3 hari yang lalu</div>
                </div>
                <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="review-text">
                    "Lobster sangat segar dan berkualitas tinggi. Ukuran sesuai dengan yang dijanjikan. 
                    Packing sangat rapi dan lobster masih hidup saat sampai. Sangat puas dengan pembelian ini!"
                </div>
            </div>
            <div class="review-item">
                <div class="review-header">
                    <div class="review-author">Sarah Johnson</div>
                    <div class="review-date">1 minggu yang lalu</div>
                </div>
                <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <div class="review-text">
                    "Kualitas lobster Indonesia tidak kalah dengan lobster dari negara lain. 
                    Daging tebal dan rasa yang lezat. Pengiriman ekspor berjalan lancar."
                </div>
            </div>
            <div class="review-item">
                <div class="review-header">
                    <div class="review-author">Michael Chen</div>
                    <div class="review-date">2 minggu yang lalu</div>
                </div>
                <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</div>
                <div class="review-text">
                    "Lobster segar dan sehat. Pelayanan sangat baik dan pengiriman tepat waktu. 
                    Akan beli lagi untuk kebutuhan restoran kami."
                </div>
            </div>
        </section>
    </main>
    
    <footer class="footer">
        <div>Lobster Marketplace &copy; 2025 | Made in Indonesia</div>
    </footer>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            const navUser = document.getElementById('nav-user');
            if (user) {
                navUser.innerHTML = `<span>üëã Hai, ${user.name}</span>
                    <button id="logoutBtn" class="logout-btn">Logout</button>`;
                document.getElementById("logoutBtn").addEventListener("click", function() {
                    localStorage.removeItem("currentUser");
                    window.location.href = "login.html";
                });
            } else {
                navUser.innerHTML = `<a href="login.html" class="login-btn">Login</a>`;
            }
            
            loadProductData();
        });

        function loadProductData() {
            // Get product ID from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            
            if (!productId) {
                alert('Produk tidak ditemukan');
                window.location.href = 'marketplace.html';
                return;
            }
            
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
            const users = JSON.parse(localStorage.getItem('users')) || [];
            
            const product = products.find(p => p.id === productId);
            
            if (!product) {
                alert('Produk tidak ditemukan');
                window.location.href = 'marketplace.html';
                return;
            }
            
            // Get farmer info
            const farmer = users.find(u => u.email === product.farmerId);
            
            // Get product reviews
            const productReviews = reviews.filter(r => r.productId === productId);
            
            updateProductDisplay(product, farmer, productReviews);
        }

        function updateProductDisplay(product, farmer, reviews) {
            // Update product title
            const productTitle = document.querySelector('.product-title');
            if (productTitle) productTitle.textContent = product.name;
            
            // Update product image
            const productImg = document.querySelector('.product-img');
            if (productImg) productImg.src = product.image;
            
            // Update product video
            const productVideo = document.querySelector('.product-video source');
            if (productVideo) productVideo.src = product.video;
            
            // Update product rating
            const productRating = document.querySelector('.product-rating');
            if (productRating) {
                productRating.innerHTML = `
                    <span>${'‚≠ê'.repeat(Math.floor(product.rating))}${'‚òÜ'.repeat(5 - Math.floor(product.rating))}</span>
                    <span>(${product.rating.toFixed(1)}/5.0)</span>
                    <span>‚Ä¢ ${reviews.length} ulasan</span>
                `;
            }
            
            // Update product price
            const productPrice = document.querySelector('.product-price');
            if (productPrice) productPrice.textContent = `Rp ${product.price.toLocaleString()}/kg`;
            
            // Update product specifications
            const productSpec = document.querySelector('.product-spec');
            if (productSpec) {
                productSpec.innerHTML = `
                    <li>
                        <span class="spec-label">Jenis Lobster:</span>
                        <span class="spec-value">${product.type}</span>
                    </li>
                    <li>
                        <span class="spec-label">Ukuran:</span>
                        <span class="spec-value">${product.size}</span>
                    </li>
                    <li>
                        <span class="spec-label">Berat:</span>
                        <span class="spec-value">${product.weight} per ekor</span>
                    </li>
                    <li>
                        <span class="spec-label">Umur:</span>
                        <span class="spec-value">${product.age}</span>
                    </li>
                    <li>
                        <span class="spec-label">Cara Budidaya:</span>
                        <span class="spec-value">Semi-intensif dengan pakan organik</span>
                    </li>
                    <li>
                        <span class="spec-label">Stok Tersedia:</span>
                        <span class="spec-value">${product.stock} kg (${Math.floor(product.stock * 2)} ekor)</span>
                    </li>
                    <li>
                        <span class="spec-label">Negara Tujuan Ekspor:</span>
                        <span class="spec-value">${product.exportCountries.join(', ')}</span>
                    </li>
                    <li>
                        <span class="spec-label">Estimasi Pengiriman:</span>
                        <span class="spec-value">${product.shippingTime}</span>
                    </li>
                `;
            }
            
            // Update product description
            const descriptionContent = document.getElementById('description');
            if (descriptionContent) {
                descriptionContent.innerHTML = `
                    <h3>Deskripsi Produk</h3>
                    <p>${product.description}</p>
                    <p>Keunggulan produk:</p>
                    <ul>
                        <li>‚úÖ Dibudidayakan dengan pakan organik premium</li>
                        <li>‚úÖ Bebas antibiotik dan bahan kimia berbahaya</li>
                        <li>‚úÖ Ukuran seragam dan berkualitas ekspor</li>
                        <li>‚úÖ Packing vacuum untuk menjaga kesegaran</li>
                        <li>‚úÖ Sertifikasi halal dan aman dikonsumsi</li>
                    </ul>
                `;
            }
            
            // Update product reviews
            updateProductReviews(reviews);
            
            // Store product ID for cart functionality
            window.currentProductId = product.id;
        }

        function updateProductReviews(reviews) {
            const reviewsSection = document.querySelector('.product-reviews');
            if (!reviewsSection) return;
            
            if (reviews.length === 0) {
                reviewsSection.innerHTML = '<h2>‚≠ê Ulasan Produk</h2><p style="text-align: center; color: #666;">Belum ada ulasan untuk produk ini</p>';
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const reviewsHTML = reviews.map(review => {
                const buyer = users.find(u => u.email === review.buyerId);
                return `
                    <div class="review-item">
                        <div class="review-header">
                            <div class="review-author">${buyer ? buyer.name : 'Anonymous'}</div>
                            <div class="review-date">${formatDate(review.createdAt)}</div>
                        </div>
                        <div class="review-rating">${'‚≠ê'.repeat(review.rating)}${'‚òÜ'.repeat(5 - review.rating)}</div>
                        <div class="review-text">"${review.comment}"</div>
                    </div>
                `;
            }).join('');
            
            reviewsSection.innerHTML = `<h2>‚≠ê Ulasan Produk</h2>${reviewsHTML}`;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) return '1 hari yang lalu';
            if (diffDays < 7) return `${diffDays} hari yang lalu`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} minggu yang lalu`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} bulan yang lalu`;
            return `${Math.floor(diffDays / 365)} tahun yang lalu`;
        }

        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        function addToCart() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                alert('Silakan login terlebih dahulu untuk menambah ke keranjang');
                window.location.href = 'login.html';
                return;
            }
            
            if (!window.currentProductId) {
                alert('Produk tidak valid');
                return;
            }
            
            // Get current cart or create new one
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            
            // Get product info
            const products = JSON.parse(localStorage.getItem('products')) || [];
            const product = products.find(p => p.id === window.currentProductId);
            
            if (!product) {
                alert('Produk tidak ditemukan');
                return;
            }
            
            // Check if product already in cart
            const existingProduct = cart.find(item => item.productId === window.currentProductId);
            if (existingProduct) {
                existingProduct.quantity += 1;
            } else {
                cart.push({
                    productId: window.currentProductId,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            alert('Produk berhasil ditambahkan ke keranjang!');
        }

        function toggleWishlist() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                alert('Silakan login terlebih dahulu untuk menambah ke wishlist');
                window.location.href = 'login.html';
                return;
            }
            
            if (!window.currentProductId) {
                alert('Produk tidak valid');
                return;
            }
            
            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            const productIndex = wishlist.indexOf(window.currentProductId);
            
            const btn = document.getElementById('wishlistBtn');
            if (productIndex === -1) {
                // Add to wishlist
                wishlist.push(window.currentProductId);
                btn.textContent = 'üíî';
                btn.style.background = '#e74c3c';
                btn.style.color = '#fff';
                alert('Produk ditambahkan ke wishlist!');
            } else {
                // Remove from wishlist
                wishlist.splice(productIndex, 1);
                btn.textContent = '‚ù§Ô∏è';
                btn.style.background = '#fff';
                btn.style.color = '#e74c3c';
                alert('Produk dihapus dari wishlist!');
            }
            
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
        }
    </script>
</body>
</html>
